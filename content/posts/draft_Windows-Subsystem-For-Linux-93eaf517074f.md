---
title: Windows Subsystem For Linux
description: >-
  බොහෝ අය දැන් වින්ඩෝස් වල ඉඳගෙනම ලිනක්ස් වල වැඩ කරනව ඇති Windows 10 Anniversary
  Update එකෙන් පස්සෙ. ඒ තමා මේ Windows Subsyestem For Linux…
date: ''
draft: true
categories: []
keywords: []
slug: ''
---

බොහෝ අය දැන් වින්ඩෝස් වල ඉඳගෙනම ලිනක්ස් වල වැඩ කරනව ඇති **Windows 10 Anniversary Update** එකෙන් පස්සෙ. ඒ තමා මේ **Windows Subsyestem For Linux** හෙවත් **WSL** භාවිතා කරමින්.

අප හොඳින්ම දන්නා කාරණාවක් තමා ලිනක්ස් සහ වින්ඩෝස් කියන්නෙ වෙනස්ම architecture දෙකකට හදපු මෙහෙයුම් පද්ධති දෙකක්. ඔබට සාමාන්‍යෙන් ලිනක්ස් Softwares වින්ඩෝස් හි ධාවනය කරන්න බැහැ. ඒ වගේම අනෙක් පසටත් වලංගුයි.

මෙයට ප්‍රධානම හේතුව ලෙස මෙම කේතයන් **compile** කිරීමේදී යොදාගන්නා **system calls** තමා හේතු වෙන්නෙ. වින්ඩෝස් සහ ලිනක්ස් මේවා වෙනස්ම ආකාරයකට තමා කේතකරනය කරල තිබෙන්නෙ.

Screen එකේ අකුරක් print කිරීමේ සිට ඉතිරි සියල්ල මෙසේ අදාල මෙහෙයුම් පද්ධතිය සමග තමා සෘජුව සම්බන්ධ වෙන්නෙ. ඔබට සරල උදාහරණයක් පහත ගෙන එන්නම්.

මෙය ඉතාම සරල **C පරිගණක භාෂාව** යොදාගෙන නිර්මාණය කරපු කේතයක්. මෙහිදී කරන්නෙ අදාල screen එක තුල කිසියම් වාක්‍යයක් දිස්වීමයි. නමුත් සරලවම මෙහ්දී **standard output** එක කුමන තිරයක කෙසේ දිස්කරනවාද යන්න මෙම වැඩසටහන නොදනී. එහිදී උපයෝගී වන්නේ පරිගණකය තුල ධාවනය වන මෙහෙයුම් පද්ධතියයි. මෙහි ඉහලම ඇති **stdio.h** නම් කේතය(header file) විසින් ඉහත **printf** ට අදාලව මෙහෙයුම් පද්ධතියට අනන්‍ය වූ ක්‍රමයකින් මෙය පෙන්වීමට අදාල **instructions** ලබාදීලා තියනවා. මෙම **printf** ක්‍රියාත්මක වනවිට අදාල මෙහෙයුම් පද්ධතිය සමග සම්බන්ධ වී එයට විධාන ලබාදෙනවා අදාල අකුර මෙන්න මේ ආකාරයට පෙන්වන්න කියල. මෙතන ක්‍රියාත්මක වෙන්නෙ **User mode to Kernal mode** කියන ක්‍රමය. ඉතින් මෙතන පෙන්වන අයුරේ පටන් User Program එක **Kernal** එකට කතා කරන එක පවා වෙනස් වෙනවා මෙහෙයුම් පද්ධතිය මත.

සරලව වින්ඩොස් වල යමක් ප්‍රින්ට් කරන විදිය ලිනක්ස් වල වෙනස්. නමුත් මෙම **stdio.h** මගින් එකම function interface එකක් ලබාදෙන නිසා මෙහෙයුම් පද්ධති දෙකට තමන්ගෙ කර්නලයට අනුකූලව implementation දෙන්න පුලුවන්.

දැන් කතාව පැත්තට හැරෙමු. ලිනක්ස් භාවිතා කරමින් වැඩ කරන්නන්ට වින්ඩෝස් හි රැදෙන්න බැරි වෙන්නෙ ලිනක්ස් වල තමන් භාවිතා කරන softwares/tools නැති වුනාම. ඉතින් මේකට විසදුම් ලෙස අපිට **cygwin** වැනි යෙදුම් භාවිතා කරන්න පුලුවන්. නමුත් මෙතනදි වුනු ප්‍රශ්නෙ තමා මේවා අදාල වින්ඩෝස් පද්ධතියට අනුකූලව port කරන්න වීම.

ඉතින් මයික්‍රසොෆ්ට් සමාගම මෙම **port** කිරීම වලකා දමා, ලිනක්ස් softwares natively වින්ඩෝස් මත ධාවනය වෙන්න විසදුමක් ගෙන ආවා.

මේක දවසෙන් දෙකෙන් වුනු දෙයක් නෙවේ. මුල සිටම **WindowsNT** Kernal එක ලියද්දි POSIX, OS/2 වැනි architecture වලට පහසුවෙන් වින්ඩෝස් හා සම්භන්ද වෙන්න ඔවුන් System API Calls හදලා තිබ්බෙ. මුල්ම Subsystems Usermode තමා ක්‍රියාත්මක වෙන්නෙ. ඔවුන්ට අවශ්‍ය System Calls **NTDLL** කියන **API**( **A**pplication **P**rogramming **I** nterface) හරහා තමා ඉටු කරල දුන්නෙ Windows.

පසුකාලීනව POSIX වෙනුවට SUA හෙවත් **Subsystem for Unix-based Applications** යොදාගන්නවා පහත දේ සපුරා ගැනීමට

*   Process and signal management
*   Terminal management
*   System service requests and inter process communication

මෙහිදී ඔවුන්ට අවැසි වුනේ අඩු ශ්‍රමයකින් native linux/unix softwares වින්ඩෝස් සදහා භාවිතා කල හැකිවීම.

මෙම පරීක්ශන වල අවසානයේ තමා මෙම **WSL** බිහිවන්නේ.

**WSL යනු සරලවම විවිධ Components රැසක එකතුවක් ලෙසයි අපට දක්වන්න පුලුවන්.**

> _මුලින්ම කියන්න ඕන දෙයක් තමා මේක තවත් Windows Program එකක් පමණක් බව._

>   

>   

User කෙනෙක්ට **WSL** භාවිතා කිරීමට උවමනා විට ඉහත තිබෙනා **bash.exe** කියන **Win32 Progam** එක ක්‍රියාත්මක කරන්න ඕන. එවිට එය **LX Session Manager Service** එක සමග සම්භන්ධ වෙනවා. මෙම **LX Session Manager** එක අදාල වින්ඩොස් පරිශීලකයාට වෙනම **Linux Instance** එකක් සාදනවා. සියලුම ලිනක්ස් Processes මෙන්න මේ instance එක තුල තමා වැඩ කරන්නෙ. මතක තියාගන්න ඕන යමක් තමා එක පරිශීලකයෙක්ට මෙම instance දැනට හැදෙන්නෙ එකයි. අදාල **NT Process** එක(bash.exe වැනි) වසා දැමූ විට මෙම instance එක ඉබේම close වෙන්න තමා හදල තියෙන්නෙ. මෙයාගෙ තව වැඩක් තමා එක අවස්ථාවක එක operation එකක් ඉවර වෙනතුරු එම resource එක අනෙක් ලිනක්ස් process වලට ලබා නොදීම.

දැන් instance එක තුලට **Native Linux Binary**( **ELF64** තමා දැනට) Load කරන්නෙ **Pico Process** එකක් ලෙස. **Pico Process** සම්බන්ධ වෙන්න **Pico Drivers** තියනව. ඒවා හරහා තමා ඒවා ගනුදෙනු කරන්නෙ. මේවා කෙලින්ම මෙහෙයුම් පද්ධතිය සමග සම්බන්ද වෙන්නෙ නෑ.

දැන් කොහොම හරි මේ native linux programs වලින් එන calls සියල්ල ලිනක්ස් කර්නලයට තමා ආමන්ත්‍රනය කරන්න යන්නෙ. නමුත් ලිනක්ස් හි තිබෙන දේවල් වින්ඩෝස් හි නෑ. ඉතින් මෙතනදි තමා ඔන්න ඔය පහල තියෙන Kernal Space එකේ ඇති **LXCore/LXSS** කියන drivers භාවිතා වෙන්නෙ. මේවා තමා මෙතන pico drivers වෙන්නෙ. දැන් මේ **lxcore.sys, lxss.sys** කියන **kernal drivers** දෙක කරන්නෙ **native linux system calls, native windows system calls** වලට පරිවර්තනය කරන එක.

උදාහරණයක් ලෙස ලිනක්ස් හි ඇති **fork, open** වැනි system calls වලට අනුරූප වින්ඩෝස් system calls **NtCreateProcess, NtOpenFile** ලෙස දක්වන්න පුලුවන්. ඉහත ලිනක්ස් calls වින්ඩෝස් වලට යවා, ඉන් අනතුරුව ලැබෙනා response එක නැවත ලිනක්ස් වලට තේරෙන්න අපි යවනවා පරිවර්තනයක් කරලා.

ඉතින් මේක කරන්න **ලිනක්ස් හි තිබෙන** **consistency** බව රුකුල් වෙලා තිබෙන බව කියන්න ඕන. ඉතාම පැරණි ලිනක්ස් කේතයක් වුවත් අද ධාවනය වෙනවා ලිනක්ස් kernal එක එම system calls වෙනස් නොකරන නිසා ලේසියෙන්.

මයික්‍රොසොෆ්ට්ලා කලේ මෙම ලිනක්ස් programs යවන system calls(syscalls) ගැන අධ්යනය කරලා, syscall එකට අදාල ක්‍රියාව වින්ඩෝස් ලවා ඉටු කරලා, මුකුත් නොවුනා වගේ යලි ලිනක්ස් program එකට ලබාදෙන එක. එම නිසා මෙම පද්ධතිය සම්පූර්ණ ලිනක්ස් එකක් නොව, තරමක් දුරට system level emulation එකක් ලෙස දැක්කට වරදක් නෑ. මෙයින් පූර්ණව අපි ලිනක්ස් වල ගන්න වැඩ කරගන්න බැරි උනත්, එදිනෙදා බොහෝ වැඩ කරගන්න හැකිවෙයි

> _මේකට සිංහල භාශාවෙ නම් කියන්නෙ උගුරට හොරා බෙහෙත් බොනව කියල. 😀_

>   

>   

දැනට WSL හි ඇති තනි Linux Instance එක වෙනුවට, multiple linux instances ධාවනය කරන්න මෙය වැඩිදියුණු කරනා බව මයික්‍රසොෆ්ට් ආයතනය ඉඟි පල කර තිබෙනවා. දැනට Ubuntu, OpenSuse , SuSe Enterprise, Fedora වැනි විවිධ ලිනක්ස් පාදක පද්ධති මෙය මගින් ධාවනය කරන්න හැකියි.

ඔබ මෙය දැනට ලබාගෙන නැතිනම් [මෙයින්](https://docs.microsoft.com/en-us/windows/wsl/install-win10) එය ලබාගන්නා අයුරු ඉගෙනගන්න.

අප අමතක කරන්න හොද නෑ **WINE** යන්න බොහෝ ලිනක්ස් පරිශීලකයන් වින්ඩෝස් softwares සමග වැඩ කිරීමට යොදාගත් බව. එහිද වන්නේ මෙවැනි ක්‍රියාවක්, නමුත් එය බොහෝ GUI සදහාද සහය දෙනවා. එය අමතක නොකල යුතුයි. එහිද වින්ඩෝස් කේත නොමැති අතර ඉහත syscall translation මගින් අදාල කටයුතු කරනවා.

ඉතින් ඉතාම සරලව නමුත් විස්තරාත්මකව මෙම ලිපිය ලිව්වා ඔබේ දැනගැනීම පිනිස. වැරදි, අදහස්, උදහස්, යෝජනා, චෝදනා ලබාදෙන මෙන් ඉල්ලා සිටිනවා මෙම ලිපි ලිවීම සාර්ථක වීමට.

යලිත් හමුවෙමු !.

_Originally published at_ [_http://kasundevblog.wordpress.com_](https://kasundevblog.wordpress.com/2018/02/13/windows-subsystem-for-linux/) _on February 12, 2018._